<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é‰„é“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", sans-serif;
      background-color: #f2f2f2;
    }

    #map {
      width: 100%;
      height: 100vh;
      z-index: 1;
    }

    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000;
      display: flex;
      gap: 8px;
    }

    .tab {
      background-color: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: background-color 0.2s;
    }

    .tab:hover {
      background-color: #e8f0fe;
    }

    .tab.active {
      background-color: #d2e3fc;
    }

    .panel {
      position: absolute;
      top: 50px;
      left: 10px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      width: 240px;
      display: none;
      z-index: 1001;
    }

    .panel.active {
      display: block;
    }

    button {
      margin-top: 4px;
      width: 100%;
      padding: 6px;
      border: none;
      border-radius: 4px;
      background-color: #4285f4;
      color: white;
      font-size: 14px;
      cursor: pointer;
    }

    button:hover {
      background-color: #3367d6;
    }

    h3 {
      margin-top: 0;
      font-size: 16px;
      text-align: center;
      color: #333;
    }

  </style>
</head>
<body>

  <div id="ui">
    <div class="tab active" data-target="buildPanel">ğŸ—ï¸ å»ºè¨­</div>
    <div class="tab" data-target="routePanel">ğŸš‰ è·¯ç·š</div>
    <div class="tab" data-target="vehiclePanel">ğŸš„ è»Šä¸¡</div>
    <div class="tab" data-target="statsPanel">ğŸ“Š çµ±è¨ˆ</div>
  </div>

  <!-- å»ºè¨­ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div class="panel active" id="buildPanel">
    <h3>å»ºè¨­ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
    <button id="stationMode">é§…è¨­ç½®ï¼ˆäºˆç®—å¿…è¦ï¼‰</button>
    <button id="trackMode">ç·šè·¯æ•·è¨­ï¼ˆäºˆç®—å¿…è¦ï¼‰</button>
    <button id="cancelBuild">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
  </div>

  <!-- è·¯ç·šãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div class="panel" id="routePanel">
    <h3>è·¯ç·šãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
    <button id="createRoute">æ–°ã—ã„è·¯ç·šã‚’ä½œæˆ</button>
    <button id="editRoute">æ—¢å­˜è·¯ç·šã‚’ç·¨é›†</button>
    <button id="deleteRoute">è·¯ç·šå‰Šé™¤</button>
  </div>

  <!-- è»Šä¸¡ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div class="panel" id="vehiclePanel">
    <h3>è»Šä¸¡ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
    <button id="buyTrain">è»Šä¸¡è³¼å…¥</button>
    <button id="assignTrain">è·¯ç·šã«å‰²ã‚Šå½“ã¦</button>
    <button id="manageTrain">è»Šä¸¡ç®¡ç†</button>
  </div>

  <!-- çµ±è¨ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div class="panel" id="statsPanel">
    <h3>çµ±è¨ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
    <button id="viewUsage">åˆ©ç”¨ãƒ‡ãƒ¼ã‚¿</button>
    <button id="viewFinance">è³‡é‡‘ã‚°ãƒ©ãƒ•</button>
    <button id="viewNetwork">è·¯ç·šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</button>
  </div>

  <div id="map"></div>

  <script>
    // === Leafletåœ°å›³åˆæœŸåŒ– ===
    const map = L.map('map').setView([35.681236, 139.767125], 12);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 19
    }).addTo(map);

    // === ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ ===
    const tabs = document.querySelectorAll('.tab');
    const panels = document.querySelectorAll('.panel');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        panels.forEach(p => p.classList.remove('active'));
        document.getElementById(tab.dataset.target).classList.add('active');
      });
    });

    // === ãƒ¢ãƒ¼ãƒ‰å¤‰æ•° ===
    let mode = null;
    const stations = [];
    const tracks = [];
    const routes = [];

    // === é§…è¨­ç½® ===
    document.getElementById('stationMode').addEventListener('click', () => {
      mode = 'station';
      alert('é§…è¨­ç½®ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚åœ°å›³ä¸Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é§…ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚');
    });

    // === ç·šè·¯æ•·è¨­ ===
    document.getElementById('trackMode').addEventListener('click', () => {
      mode = 'track';
      alert('ç·šè·¯æ•·è¨­ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚é§…åŒå£«ã‚’çµã‚“ã§ãã ã•ã„ã€‚');
    });

    // === ã‚­ãƒ£ãƒ³ã‚»ãƒ« ===
    document.getElementById('cancelBuild').addEventListener('click', () => {
      mode = null;
      alert('å»ºè¨­ãƒ¢ãƒ¼ãƒ‰ã‚’è§£é™¤ã—ã¾ã—ãŸã€‚');
    });

    // === è·¯ç·šä½œæˆ ===
    document.getElementById('createRoute').addEventListener('click', () => {
      mode = 'route';
      alert('è·¯ç·šä½œæˆãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚é§…ã‚’é¸æŠã—ã¦ç’°çŠ¶è·¯ç·šã‚’ä½œæˆã—ã¾ã™ã€‚');
    });

    // === åœ°å›³ã‚¯ãƒªãƒƒã‚¯å‹•ä½œ ===
    let tempTrack = [];
    map.on('click', function(e) {
      if (mode === 'station') {
        const marker = L.marker(e.latlng).addTo(map);
        stations.push(e.latlng);
        marker.bindTooltip(`é§…${stations.length}`, {permanent: true, direction: 'right'});
      } else if (mode === 'track') {
        tempTrack.push(e.latlng);
        if (tempTrack.length === 2) {
          const line = L.polyline(tempTrack, {color: '#555', weight: 4}).addTo(map);
          tracks.push(line);
          tempTrack = [];
        }
      } else if (mode === 'route') {
        tempTrack.push(e.latlng);
        if (tempTrack.length >= 3) {
          const line = L.polyline([...tempTrack, tempTrack[0]], {color: '#1a73e8', weight: 3, dashArray: '5,5'}).addTo(map);
          routes.push(line);
          alert('ç’°çŠ¶è·¯ç·šã‚’ä½œæˆã—ã¾ã—ãŸã€‚');
          tempTrack = [];
        }
      }
    });
  </script>

</body>
</html>
